sequenceDiagram
    participant User
    participant System as Custody System
    participant HotWallet as Hot Wallet
    participant ColdWallet as Cold Wallet
    participant Audit as Transaction Log
    
    User->>System: Create hot wallet (id, address, type)
    System->>HotWallet: Initialize wallet with zero balance
    HotWallet-->>System: Wallet created
    System-->>User: Hot wallet ready
    
    User->>System: Create cold wallet (id, address, type)
    System->>ColdWallet: Initialize wallet with zero balance
    ColdWallet-->>System: Wallet created
    System-->>User: Cold wallet ready
    
    User->>System: Deposit to hot wallet
    System->>HotWallet: Check wallet exists
    HotWallet-->>System: Wallet valid
    System->>System: Validate amount > 0
    System->>HotWallet: Add funds
    System->>Audit: Record deposit transaction
    System-->>User: Deposit confirmed
    
    User->>System: Withdraw from hot wallet
    System->>HotWallet: Check balance
    System->>System: Validate amount > 0
    alt Sufficient balance
        HotWallet-->>System: Balance OK
        System->>HotWallet: Deduct funds
        System->>Audit: Record withdrawal transaction
        System-->>User: Withdrawal successful
    else Insufficient balance
        HotWallet-->>System: Insufficient funds
        System-->>User: Error: Insufficient balance
    end
    
    User->>System: Get total balance
    System->>HotWallet: Query balance
    System->>ColdWallet: Query balance
    HotWallet-->>System: Hot balance
    ColdWallet-->>System: Cold balance
    System->>System: Calculate total
    System-->>User: Total balance
